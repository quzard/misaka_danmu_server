# 常见问题

## 忘记密码怎么办？

如果您忘记了管理员密码，可以通过以下步骤在服务器上重置：

1.  通过 SSH 或其他方式登录到您的服务器。

2.  进入您存放 `docker-compose.yml` 的目录。

3.  执行以下命令来重置指定用户的密码。请将 `<username>` 替换为您要重置密码的用户名（例如 `admin`）。

    ```bash
     docker-compose exec danmu-api python -m src.reset_password <username>
    ```

    > **注意**: 如果您没有使用 `docker-compose`，或者您的容器名称不是 `danmu-api`，请使用 `docker exec` 命令：
    > `docker exec <您的容器名称> python -m src.reset_password <username>`

4.  命令执行后，终端会输出一个新的随机密码。请立即使用此密码登录，并在 "设置" -> "账户安全" 页面中修改为您自己的密码。

## 数据库文件越来越大怎么办？

随着时间的推移，数据库占用的磁盘空间可能会逐渐增大。这通常由两个原因造成：

1.  **应用日志**: 任务历史、API访问记录等会存储在数据库中。这些日志会由内置的 **"数据库维护"** 定时任务自动清理（默认保留最近3天）。
2.  **MySQL二进制日志 (Binlog)**: 这是MySQL用于数据恢复和主从复制的日志，如果不进行管理，它会持续增长。

本项目内置的"数据库维护"任务会**尝试自动清理**旧的Binlog文件。但由于权限问题，您可能会在日志中看到"Binlog 清理失败"的警告。这是一个正常且可安全忽略的现象。

如果您关心磁盘空间占用，并希望启用Binlog的自动清理功能，请参阅详细的解决方案：

- **[缓存日志清理任务说明](./缓存日志清理任务说明.md)**

> **对于PostgreSQL用户**: PostgreSQL没有Binlog机制，其WAL日志通常会自动管理，因此空间占用问题没有MySQL那么突出。您只需关注应用日志的自动清理即可。

## 国外VPS搭建弹幕库搜索不到内容怎么办？

如果您在国外VPS上部署本项目，可能会遇到搜索不到弹幕或搜索结果很少的问题。这主要是由于原因：**IP地区限制**

部分弹幕源（如B站、爱奇艺、腾讯视频等）的搜索接口存在IP地区限制，出于版权保护考虑，这些接口可能只对大陆IP开放完整的搜索结果。

### 解决方案：VPS回家

为了获得完整的搜索体验，建议使用"VPS回家"的方案，即让您的国外VPS通过国内网络进行弹幕搜索。

**推荐方案**：
- 使用国内中转服务器或代理
- 配置网络路由，让弹幕搜索请求通过国内IP发出
- 使用VPN或隧道技术将流量回传到国内

**详细教程**：
群友 [@wdnmlgbd](https://blog.tencentx.de/) 提供了完整的解决方案：
- **教程链接**: [国外VPS搭建的MisakaDump正常获取bilibili弹幕](https://blog.tencentx.de/p/build-%E5%9B%BD%E5%A4%96vps%E6%90%AD%E5%BB%BA%E7%9A%84misakadump%E6%AD%A3%E5%B8%B8%E8%8E%B7%E5%8F%96bilibili%E5%BC%B9%E5%B9%95/)
